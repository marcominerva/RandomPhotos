@page
@model IndexModel

@section RightCommands
    {
    <div x-data>
        <button type="button" class="btn btn-primary" x-on:click="$dispatch('refresh')"
                data-bs-toggle="tooltip"
                data-bs-title="@Resources.Pages.Index.Refresh">
            <i class="bi bi-arrow-clockwise"></i>
        </button>
    </div>
}

<div x-data="photos" @@refresh.window="generatePhoto">

    <div class="row" x-cloak x-show="isBusy">
        <div class="mt-5 text-center">
            <div class="spinner-border text-primary" style="width: 4rem; height: 4rem;" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>

    <div x-cloak class="row" x-init="$nextTick(() => generatePhoto())" x-show="imageUrl != null">
        <div class="col text-center">
            <a x-bind:href="imageUrl" class="lightbox" x-bind:data-footer="description">
                <img x-bind:src="imageUrl" class="photo img-thumbnail" x-bind:alt="description">
            </a>
        </div>
        <div class="mt-2">
            <span x-text="description"></span>
        </div>
    </div>

    <template x-if="errorMessage">
        <div class="row">
            <div class="alert alert-danger fade show mt-3" role="alert">
                <i class="bi bi-exclamation-triangle-fill me-2" aria-hidden="true"></i>
                <span x-html="errorMessage"></span>
            </div>
        </div>
    </template>

</div>

@section Scripts
    {
    @{
        <script>
            document.addEventListener("alpine:init", () => {
                photos('@Thread.CurrentThread.CurrentUICulture.TwoLetterISOLanguageName');
            });
        </script>
    }
}
